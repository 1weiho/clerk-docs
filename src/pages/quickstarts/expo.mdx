import { Tab, Tabs } from "nextra-theme-docs";
import { Callout } from "nextra-theme-docs";
import {YouTube} from "@/components/Youtube"
import {Images} from "@/components/Images";

# Use Clerk with Expo

Learn how to use Clerk with Expo including protecting pages and retrieving user data.

## Install @clerk/clerk-expo

<Callout type="warning">
Currently Clerk only works with Expo SDK 47 or lower. We are working on supporting the latest Expo SDK.
</Callout>

Once you have your Expo application ready, you need to install Clerk's Expo SDK. This gives you access to our control components, hooks to create custom flows and access user data.

<Tabs items={['npm', 'yarn', 'pnpm']}>
<Tab>
```
npm install @clerk/clerk-expo
```
</Tab>
<Tab>
```
yarn add @clerk/clerk-expo
```
</Tab>
<Tab>
```
pnpm i @clerk/clerk-expo
```
</Tab>
</Tabs>


## Configure `<ClerkProvider>`

Clerk requires your Expo application to be wrapped in the `<ClerkProvider/>` component. The `<ClerkProvider />` component provides active session and user context to Clerk's hooks and other components.

```tsx filename="app.tsx" copy
import React from "react";
import { Text } from "react-native";
import { SafeAreaProvider } from "react-native-safe-area-context";
import { ClerkProvider } from "@clerk/clerk-expo";

export default function App() {
  return (
    <ClerkProvider publishableKey="pk_test_••••••••••••••••••••••••••••••••••">
      <SafeAreaProvider>
        <Text>Hello world!</Text>
      </SafeAreaProvider>
    </ClerkProvider>
  );
}
```

## Protecting Your Pages

Clerk offers Control Components that allow you to protect your pages. In the example below we are using [`<SignedIn/>`](/components/user-management/signed-in) and [`<SignedOut/>`](components/user-management/signed-out)  control components.

```tsx filename="app.tsx" copy
import { Text } from "react-native";
import { ClerkProvider, SignedIn, SignedOut } from "@clerk/clerk-expo";

export default function App() {
  return (
    <ClerkProvider publishableKey="pk_test_••••••••••••••••••••••••••••••••••">
      <SignedIn>
        <Text>You are Signed in</Text>
      </SignedIn>
      <SignedOut>You are Signed out</SignedOut>
    </ClerkProvider>
  );
}
```

## Allowing your users to sign in or sign up

Using expo requires you to create custom flows in our quickstart guide, we are going to show you how to create a sign in and sign up flow using the `useSignIn` and `useSignUp` hooks. 

### Sign Up

The examples below use email and password to sign a user up. You will notice that we have implemented two components for the sign up flow. The first component is the `SignUpScreen` component which is responsible for rendering the sign up form and handling the sign up flow. The second component is the `verifyEmail` component which is responsible for verifying the users email which is an required step in the sign up flow.


### Sign In

```tsx filename="sign-in.tsx" copy
import React from "react";
import { Text, TextInput, TouchableOpacity, View } from "react-native";
import { useSignIn } from "@clerk/clerk-expo";

export default function SignInScreen(){
  const { signIn, setSession, isLoaded } = useSignIn();

  const [emailAddress, setEmailAddress] = React.useState("");
  const [password, setPassword] = React.useState("");

  const onSignInPress = async () => {
    if (!isLoaded) {
      return;
    }

    try {
      const completeSignIn = await signIn.create({
        identifier: emailAddress,
        password,
      });
      // This is an important step, otherwise Clerk will assume that the user is not signed in.
      await setActive(completeSignIn.createdSessionId);
    } catch (err: any) {
        console.log(err)
    }
  };
  return (
    <View>
      <View>
        <TextInput
          autoCapitalize="none"
          value={emailAddress}
          placeholder="Email..."
          placeholderTextColor="#000"
          onChangeText={(emailAddress) => setEmailAddress(emailAddress)}
        />
      </View>

      <View >
        <TextInput
          value={password}
          style={styles.textInput}
          placeholder="Password..."
          placeholderTextColor="#000"
          secureTextEntry={true}
          onChangeText={(password) => setPassword(password)}
        />
      </View>

      <TouchableOpacity onPress={onSignInPress}>
        <Text >Sign in</Text>
      </TouchableOpacity>
    </View>
  );
}
```

## Accessing Auth Data

Clerk provides a set of hooks and helpers that you can use to access the active session and user data in your Expo application. We have included examples of how to use these helpers to get you started.

#### `useAuth`

The `useAuth` hook is a convenient way to access the current auth state. This hook provides the minimal information needed for data-loading and helper methods to manage the current active session.
  
  ```tsx copy filename="pages/example.tsx"
  import { useAuth } from '@clerk/clerk-expo';

  export default function Example() {
  const { isLoaded, userId, sessionId, getToken } = useAuth();
  
  // In case the user signs out while on the page.
  if (!isLoaded || !userId) {
    return null;
  }

  return <div>Hello, {userId} your current active session is {sessionId}</div>;
  };
  ```

#### `useUser`


The `useUser` hook is a convenient way to access the current user data where you need it. This hook provides the user data and helper methods to manage the current active session.

```tsx copy filename="pages/example.tsx"
import { useUser } from '@clerk/clerk-expo';

  export default function Example() {
  const { isLoaded, isSignedIn, user } = useUser()

  if (!isLoaded || !isSignedIn) {
    return null
  }

  return <div>Hello, {user.firstName} welcome to Clerk</div>;
  };

export default Example
````

## Next Steps

Now you have an application integrated with Clerk you will want to read the following documentation:

- [Client side helpers](/sdk/shared/use-auth)