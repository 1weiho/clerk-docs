---
title: OAuth connections
description: Learn how to leverage the Clerk SDK to build completely custom OAuth flows.
---

# OAuth connections

<Callout type="danger">
  This guide is for users who want to build a *custom* user interface using the Clerk API. To sign in users with multi-factor authentication (MFA) using a *prebuilt* UI, you should use Clerk's [Account Portal pages](/docs/account-portal/overview) or [prebuilt components](/docs/components/overview).
</Callout>

## Before you start

You must configure your application instance through the Clerk Dashboard for the social connection(s) that you want to use, as described at [the top of the OAuth guide](/docs/authentication/social-connections/oauth#configuration).

## Create the sign-up and sign-in flow

When using OAuth, the sign-up and sign-in are equivalent. A successful OAuth flow consists of the following steps:

1. Start the OAuth flow by calling [`SignIn.authenticateWithRedirect(params)`](/docs/references/javascript/sign-in/authenticate-with#authenticate-with-redirect) or [`SignUp.authenticateWithRedirect(params)`](/docs/references/javascript/sign-up/authenticate-with#authenticate-with-redirect). Note that both of these methods require a `redirectUrl` param, which is the URL that the browser will be redirected to once the user authenticates with the OAuth provider.
2. Create a route at the URL `redirectUrl` points, typically `/sso-callback`, that calls the [`Clerk.handleRedirectCallback()`](/docs/references/javascript/clerk/handle-navigation#handle-redirect-callback) or simply renders the prebuilt [`<AuthenticateWithRedirectCallback/>`](/docs/components/control/authenticate-with-callback) component.

The following example shows two files:

1. The sign-up page where the user can start the OAuth flow.
2. The SSO callback page where the OAuth flow is completed.

<Tabs items={["Next.js"]}>
  <Tab>
  <CodeBlockTabs options={["Sign up page", "SSO callback page"]}>
    ```jsx filename="app/sign-up/[[...sign-up]]/page.tsx"
    'use client';

    import * as React from 'react';
    import { OAuthStrategy } from '@clerk/types';
    import { useSignIn } from '@clerk/nextjs';

    export default function OauthSignIn() {
      const { signIn } = useSignIn();

      if (!signIn) return null;

      const signInWith = (strategy: OAuthStrategy) => {
        return signIn.authenticateWithRedirect({
          strategy,
          redirectUrl: '/sign-up/sso-callback',
          redirectUrlComplete: '/',
        });
      };

      // Render a button for each supported OAuth provider
      // you want to add to your app
      return (
        <div>
          <button onClick={() => signInWith('oauth_google')}>
            Sign in with Google
          </button>
        </div>
      );
    }
    ```

    ```jsx filename="app/sign-up/sso-callback/page.tsx"
    import { AuthenticateWithRedirectCallback } from '@clerk/nextjs';

    export default function SSOCallback() {
      console.log('testing');
      // Handle the redirect flow by rendering the
      // prebuilt AuthenticateWithRedirectCallback component.
      // This is the final step in the custom OAuth flow
      return <AuthenticateWithRedirectCallback />;
    }
    ```
  </CodeBlockTabs>
  </Tab>
</Tabs>

## OAuth for React Native applications

With Clerk, you can add OAuth flows in your [React Native or Expo applications](/docs/quickstarts/expo).

Clerk ensures that security critical nonces will be passed only to allowlisted URLs when the OAuth flow is complete in native browsers or webviews.

So for maximum security in your production instances, you need to allowlist your custom redirect URLs via the [Clerk Dashboard](https://dashboard.clerk.com/) or the [Clerk Backend API](https://clerk.com/docs/reference/backend-api/tag/Redirect-URLs).

To allowlist a redirect URL via the Clerk Dashboard:
1. Navigate to the [Clerk Dashboard](https://dashboard.clerk.com/last-active?path=user-authentication/social-connections).
2. In the navigation sidebar, select **User & Authentication > Social Connections**.
3. Select the **Setting** tab and add your redirect URL to the **Redirect URLs** list.

## OAuth account transfer flow

When a user initiates an OAuth verification during sign-in or sign-up, it may sometimes be necessary to move the verification between the two flows.

For example, if someone already has an account, and tries to go through the sign up flow with the same OAuth account, they can't perform a successful sign-up again. Or, if someone attempts to sign in with their OAuth credentials but does not yet have an account, they won't be signed in to the account. For these scenarios, Clerk provides "account transfers."

<CodeBlockTabs type="framework" options={["JavaScript"]}>
```js
// Get sign-in and sign-up objects in the OAuth callback page
const { signIn, signUp } = window.Clerk.client;

// If the user has an account in your application, but does not yet
// have an oauth account connected, you can use the transfer method to
// forward that information.

const userExistsButNeedsToSignIn =
  signUp.verifications.externalAccount.status === "transferable" &&
  signUp.verifications.externalAccount.error?.code ===
    "external_account_exists";

if (userExistsButNeedsToSignIn) {
  const res = await signIn.create({ transfer: true });
  if (res.status === "complete") {
    window.Clerk.setActive({
      session: res.createdSessionId,
    });
  }
}

// If the user has an existing oauth account but does not yet exist as
// a user in your app, you can use the transfer method to forward that
// information.

const userNeedsToBeCreated =
  signIn.firstFactorVerification.status === "transferable";

if (userNeedsToBeCreated) {
  const res = await signUp.create({
    transfer: true,
  });
  if (res.status === "complete") {
    window.Clerk.setActive({
      session: res.createdSessionId,
    });
  }
}
```
</CodeBlockTabs>
